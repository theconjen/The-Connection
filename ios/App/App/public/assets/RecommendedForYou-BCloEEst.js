import{j as e}from"./vendor-radix-Cb0-vzxO.js";import{i as s,C as a,b as t,f as r,a as n,B as i,c,L as o}from"./index-CQmKbNyS.js";import{u as m,c as l,a as d}from"./vendor-query-qkAKzVJ0.js";import{S as x,T as h,i as p,n as j,M as u,ar as N,C as g}from"./vendor-icons-CM8Yk8yJ.js";import{a as f}from"./vendor-utils-nlnd1Dju.js";function y(){const e=function(){const e=l();return d({mutationFn:async e=>{const s=await fetch("/api/recommendations/interaction",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok)throw new Error("Failed to record interaction");return s.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["/api/recommendations/feed"]})}})}();return{trackView:(s,a)=>{e.mutate({contentId:s,contentType:a,interactionType:"view"})},trackLike:(s,a)=>{e.mutate({contentId:s,contentType:a,interactionType:"like"})},trackComment:(s,a)=>{e.mutate({contentId:s,contentType:a,interactionType:"comment"})},trackShare:(s,a)=>{e.mutate({contentId:s,contentType:a,interactionType:"share"})},isRecording:e.isPending}}function b({section:l,maxItems:d=3,showHeader:b=!0}){const{data:v,isLoading:w,error:k,refetch:T,isFetching:C}=function(e=20){return m({queryKey:["/api/recommendations/feed",e],queryFn:async()=>(await s("GET",`/api/recommendations/feed?limit=${e}`)).json(),staleTime:3e5,refetchOnWindowFocus:!1})}(2*d),{trackView:F,trackLike:z,trackShare:R}=y();if(w)return e.jsxs(a,{className:"border-l-4 border-l-primary",children:[e.jsx(t,{className:"pb-3",children:e.jsxs(r,{className:"flex items-center gap-2",children:[e.jsx(x,{className:"w-5 h-5 text-primary"}),"Recommended For You"]})}),e.jsx(n,{children:e.jsx("div",{className:"animate-pulse space-y-3",children:Array.from({length:d}).map((s,a)=>e.jsx("div",{className:"border rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-12 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/3"})]})]})},a))})})]});if(k||!v?.microblogs?.length)return e.jsxs(a,{className:"border-l-4 border-l-primary",children:[e.jsx(t,{className:"pb-3",children:e.jsxs(r,{className:"flex items-center gap-2",children:[e.jsx(x,{className:"w-5 h-5 text-primary"}),"Recommended For You"]})}),e.jsxs(n,{className:"text-center py-6",children:[e.jsx(x,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"No recommendations available yet"}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Interact with content to get personalized recommendations"}),e.jsx(i,{onClick:()=>T(),variant:"outline",size:"sm",children:"Refresh Recommendations"})]})]});const I=v.microblogs.slice(0,d).map(e=>({...e,section:l}));return e.jsxs(a,{className:"border-l-4 border-l-primary hover:shadow-lg transition-shadow",children:[b&&e.jsxs(t,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(r,{className:"flex items-center gap-2",children:[e.jsx(x,{className:"w-5 h-5 text-primary"}),"Recommended For You"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{variant:"secondary",className:"text-xs",children:v.algorithm||"Faith-based AI"}),e.jsx(i,{onClick:()=>T(),disabled:C,variant:"ghost",size:"sm",children:e.jsx(h,{className:"w-4 h-4 "+(C?"animate-spin":"")})})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Personalized for your spiritual journey"})]}),e.jsxs(n,{className:"space-y-3",children:[I.map((s,a)=>e.jsx("div",{className:"border rounded-lg p-3 hover:bg-muted/50 transition-colors",onClick:()=>F(s.id,"microblog"),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-primary to-secondary rounded-full flex items-center justify-center text-white text-sm font-semibold",children:(s.user?.displayName||s.user?.username||"U").charAt(0).toUpperCase()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-sm truncate",children:s.user?.displayName||s.user?.username||"Anonymous"}),e.jsxs(c,{variant:"outline",className:"text-xs",children:["Score: ",s.score]})]}),e.jsxs("span",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx(p,{className:"w-3 h-3"}),f(new Date(s.createdAt))," ago"]})]}),e.jsx("p",{className:"text-sm text-foreground mb-2 line-clamp-3",children:s.content}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1 text-xs text-primary",children:[e.jsx(h,{className:"w-3 h-3"}),e.jsx("span",{children:s.reason})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(i,{variant:"ghost",size:"sm",onClick:e=>{e.stopPropagation(),z(s.id,"microblog")},className:"h-7 px-2 text-xs",children:[e.jsx(j,{className:"w-3 h-3 mr-1"}),s.likeCount||0]}),e.jsxs(i,{variant:"ghost",size:"sm",className:"h-7 px-2 text-xs",children:[e.jsx(u,{className:"w-3 h-3 mr-1"}),s.replyCount||0]}),e.jsx(i,{variant:"ghost",size:"sm",onClick:e=>{e.stopPropagation(),R(s.id,"microblog")},className:"h-7 px-2 text-xs",children:e.jsx(N,{className:"w-3 h-3"})})]})]})]})]})},`${s.id}-${a}`)),0===I.length&&e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-muted-foreground text-sm",children:"No recommendations available"})}),b&&I.length>0&&e.jsx("div",{className:"pt-3 border-t",children:e.jsx(o,{href:`/${"feed"===l?"microblogs":l}`,children:e.jsxs(i,{variant:"ghost",size:"sm",className:"w-full text-primary hover:text-primary/80",children:["View More Recommendations",e.jsx(g,{className:"w-4 h-4 ml-1"})]})})})]})]})}export{b as R};
