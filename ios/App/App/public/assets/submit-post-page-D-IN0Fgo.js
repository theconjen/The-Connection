import{r as e,j as s}from"./vendor-radix-Cb0-vzxO.js";import{u as r,a as n}from"./vendor-query-qkAKzVJ0.js";import{u as t,h as a,n as i,C as l,b as o,f as d,a as c,I as h,B as m,i as u}from"./index-CQmKbNyS.js";import{M as x}from"./main-layout-BqoyFj5l.js";import{u as p,F as j,a as g,b as v,c as f,d as b,e as w,t as y}from"./form-Z2c2XcTx.js";import{T as N}from"./textarea-BQP-18ak.js";import{S as k,a as C,b as S,c as I,d as L}from"./select-BoJ0bQCi.js";import{C as P}from"./checkbox-BNsZ7Wa0.js";import{S as V}from"./skeleton-D3l7g_Rg.js";import{q as U}from"./vendor-icons-CM8Yk8yJ.js";import{o as B,b as T,c as q,s as F}from"./types-DUVubNlp.js";import"./vendor-react-eVk5PToZ.js";import"./vendor-utils-nlnd1Dju.js";import"./label-BZLDYjV_.js";const H=B({title:F().min(3,"Title must be at least 3 characters").max(300,"Title cannot exceed 300 characters"),content:F().min(10,"Content must be at least 10 characters"),imageUrl:F().optional(),communityId:q.number().optional(),groupId:q.number().optional(),includeScripture:T().default(!1)});function O(){const{user:B}=t(),{toast:T}=a(),[,q]=i(),[F,O]=e.useState(""),{data:G,isLoading:M}=r({queryKey:["/api/communities"]}),{data:R,isLoading:W}=r({queryKey:["/api/communities"],enabled:!!B}),A=p({resolver:y(H),defaultValues:{title:"",content:"",imageUrl:"",communityId:void 0,groupId:void 0,includeScripture:!1}}),E=n({mutationFn:async e=>{let s=e.content;e.includeScripture&&F&&(s+=`\n\n${F}`);const r={title:e.title,content:s,authorId:B.id},n=e;n.imageUrl&&(r.imageUrl=n.imageUrl),n.communityId&&(r.communityId=n.communityId),n.groupId&&(r.groupId=n.groupId);const t=await u("POST","/api/posts",r);return await t.json()},onSuccess:e=>{T({title:"Post Created",description:"Your post has been created successfully!"}),q(`/posts/${e.id}`)},onError:e=>{T({title:"Post Creation Failed",description:e.message,variant:"destructive"})}});return s.jsxs(x,{children:[s.jsx("div",{className:"flex-1",children:s.jsxs(l,{children:[s.jsx(o,{children:s.jsx(d,{className:"text-2xl",children:"Create a Post"})}),s.jsx(c,{children:s.jsx(j,{...A,children:s.jsxs("form",{onSubmit:A.handleSubmit(e=>{E.mutate(e)}),className:"space-y-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsx(g,{control:A.control,name:"communityId",render:({field:e})=>s.jsxs(v,{children:[s.jsx(f,{children:"Community"}),s.jsxs(k,{onValueChange:e.onChange,defaultValue:e.value?.toString(),disabled:M,children:[s.jsx(b,{children:s.jsx(C,{children:s.jsx(S,{placeholder:"Select a community"})})}),s.jsx(I,{children:M?s.jsx("div",{className:"p-2",children:s.jsx(V,{className:"h-4 w-full"})}):G?.map(e=>s.jsxs(L,{value:e.id.toString(),children:["r/",e.slug]},e.id))})]}),s.jsx(w,{})]})}),s.jsx(g,{control:A.control,name:"groupId",render:({field:e})=>s.jsxs(v,{children:[s.jsx(f,{children:"Private Group (Optional)"}),s.jsxs(k,{onValueChange:e.onChange,defaultValue:e.value?.toString(),disabled:W||!B,children:[s.jsx(b,{children:s.jsx(C,{children:s.jsx(S,{placeholder:"Select a private group"})})}),s.jsx(I,{children:W?s.jsx("div",{className:"p-2",children:s.jsx(V,{className:"h-4 w-full"})}):R&&R.length>0?R.map(e=>s.jsx(L,{value:e.id.toString(),children:e.name},e.id)):s.jsx("div",{className:"p-2 text-sm text-neutral-500",children:"You have no private groups"})})]}),s.jsx(w,{})]})})]}),s.jsx(g,{control:A.control,name:"title",render:({field:e})=>s.jsxs(v,{children:[s.jsx(f,{children:"Title"}),s.jsx(b,{children:s.jsx(h,{placeholder:"Enter your post title",...e})}),s.jsx(w,{})]})}),s.jsx(g,{control:A.control,name:"content",render:({field:e})=>s.jsxs(v,{children:[s.jsx(f,{children:"Content"}),s.jsx(b,{children:s.jsx(N,{placeholder:"Share your thoughts, questions, or insights...",className:"min-h-[200px]",...e})}),s.jsx(w,{})]})}),s.jsx(g,{control:A.control,name:"imageUrl",render:({field:e})=>s.jsxs(v,{children:[s.jsx(f,{children:"Image URL (Optional)"}),s.jsx(b,{children:s.jsx(h,{placeholder:"https://example.com/your-image.jpg",...e})}),s.jsx(w,{})]})}),s.jsx(g,{control:A.control,name:"includeScripture",render:({field:e})=>s.jsxs(v,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[s.jsx(b,{children:s.jsx(P,{checked:e.value,onCheckedChange:e.onChange})}),s.jsxs("div",{className:"space-y-1 leading-none",children:[s.jsx(f,{children:"Include Scripture"}),s.jsx("p",{className:"text-sm text-neutral-500",children:"Add a Bible verse to your post"})]})]})}),A.watch("includeScripture")&&s.jsxs("div",{children:[s.jsx(f,{children:"Select Scripture"}),s.jsxs("select",{className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",onChange:e=>{const s=e.target.value;O("john316"===s?'"For God so loved the world that he gave his one and only Son, that whoever believes in him shall not perish but have eternal life." - John 3:16':"proverbs3"===s?'"Trust in the LORD with all your heart and lean not on your own understanding; in all your ways submit to him, and he will make your paths straight." - Proverbs 3:5-6':"psalm23"===s?'"The LORD is my shepherd, I lack nothing. He makes me lie down in green pastures, he leads me beside quiet waters, he refreshes my soul." - Psalm 23:1-3':"romans828"===s?'"And we know that in all things God works for the good of those who love him, who have been called according to his purpose." - Romans 8:28':"")},children:[s.jsx("option",{value:"",children:"Select a verse"}),s.jsx("option",{value:"john316",children:"John 3:16"}),s.jsx("option",{value:"proverbs3",children:"Proverbs 3:5-6"}),s.jsx("option",{value:"psalm23",children:"Psalm 23:1-3"}),s.jsx("option",{value:"romans828",children:"Romans 8:28"})]}),F&&s.jsx("div",{className:"mt-2 p-4 bg-neutral-50 border-l-4 border-primary rounded italic",children:F})]})]}),s.jsxs("div",{className:"flex justify-end space-x-2",children:[s.jsx(m,{type:"button",variant:"outline",onClick:()=>q("/"),children:"Cancel"}),s.jsx(m,{type:"submit",disabled:E.isPending,children:E.isPending?s.jsxs(s.Fragment,{children:[s.jsx(U,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating..."]}):"Create Post"})]})]})})})]})}),s.jsx("aside",{className:"hidden lg:block w-80 space-y-6 sticky top-24 self-start",children:s.jsxs(l,{children:[s.jsx(o,{className:"bg-neutral-50 border-b border-neutral-200",children:s.jsx(d,{className:"text-neutral-800",children:"Posting Guidelines"})}),s.jsxs(c,{className:"p-4",children:[s.jsxs("ul",{className:"space-y-3 text-sm",children:[s.jsxs("li",{className:"flex items-start",children:[s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-green-500 mt-1 mr-2 h-4 w-4",children:[s.jsx("polyline",{points:"9 11 12 14 22 4"}),s.jsx("path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"})]}),s.jsx("span",{children:"Be respectful and thoughtful in your posts."})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-green-500 mt-1 mr-2 h-4 w-4",children:[s.jsx("polyline",{points:"9 11 12 14 22 4"}),s.jsx("path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"})]}),s.jsx("span",{children:"Include relevant details to encourage meaningful discussion."})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-green-500 mt-1 mr-2 h-4 w-4",children:[s.jsx("polyline",{points:"9 11 12 14 22 4"}),s.jsx("path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"})]}),s.jsx("span",{children:"Cite Scripture references when applicable."})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-green-500 mt-1 mr-2 h-4 w-4",children:[s.jsx("polyline",{points:"9 11 12 14 22 4"}),s.jsx("path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"})]}),s.jsx("span",{children:"Keep content appropriate and edifying."})]})]}),s.jsx("div",{className:"mt-4 p-3 bg-neutral-50 border rounded text-sm text-neutral-700",children:s.jsx("p",{className:"italic",children:'"Let your conversation be always full of grace, seasoned with salt, so that you may know how to answer everyone." - Colossians 4:6'})})]})]})})]})}export{O as default};
