import{r as e,j as s,a5 as a}from"./vendor-radix-Cb0-vzxO.js";import{u as i,n as t,I as l,A as r,e as d,B as c,J as n,c as m}from"./index-CQmKbNyS.js";import{u as x}from"./vendor-query-qkAKzVJ0.js";import{A as o}from"./admin-layout-DGdpTm_4.js";import{T as h,a as j,b as p,c as u}from"./tabs-N8_zO4xm.js";import{D as N,b as v,c as f,d as g,e as w,f as y}from"./dialog-BfqlROKo.js";import{L as b}from"./label-BZLDYjV_.js";import{T as A}from"./textarea-BQP-18ak.js";import{T as C,a as S,b as R,c as E,d as k,e as L}from"./table-Dr1qxf9w.js";import{S as F,a as P,b as T,c as O,e as I,f as B,d as D}from"./select-BoJ0bQCi.js";import{S as M}from"./separator-BRrBbODb.js";import{q,g as z,a3 as K,c as V,aM as W,K as J}from"./vendor-icons-CM8Yk8yJ.js";import"./vendor-react-eVk5PToZ.js";import"./vendor-utils-nlnd1Dju.js";function U(){const{user:U,isLoading:$,isAuthenticated:H}=i(),[,X]=t(),[Y,G]=e.useState(""),[Q,Z]=e.useState("all"),[_,ee]=e.useState(null),[se,ae]=e.useState(!1),[ie,te]=e.useState(null),[le,re]=e.useState(""),[de,ce]=e.useState("approved"),{data:ne=[],isLoading:me,refetch:xe}=x({queryKey:["/api/admin/apologist-scholar-applications"],retry:!1,enabled:!(!H||!U?.isAdmin),queryFn:async()=>{const e=await fetch("/api/admin/apologist-scholar-applications");if(!e.ok)throw new Error("Failed to fetch applications");return e.json()}});if($)return s.jsx("div",{className:"flex h-screen items-center justify-center",children:s.jsx(q,{className:"h-8 w-8 animate-spin text-primary"})});if(!H)return X("/login"),null;if(!U?.isAdmin)return X("/"),null;const oe=ne.filter(e=>{const s=e.fullName.toLowerCase().includes(Y.toLowerCase())||e.user?.email.toLowerCase().includes(Y.toLowerCase())||e.user?.username.toLowerCase().includes(Y.toLowerCase())||e.areasOfExpertise.toLowerCase().includes(Y.toLowerCase()),a="all"===Q||e.status===Q;return s&&a})||[],he=e=>{te(e),re(e.reviewNotes||""),ce("approved"===e.status?"approved":"rejected"),ae(!0)},je=e=>{const s=new Date(e);return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(s)},pe=({status:e})=>{switch(e){case"pending":return s.jsx(m,{variant:"outline",className:"bg-amber-50 text-amber-700 border-amber-200",children:"Pending"});case"approved":return s.jsx(m,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:"Approved"});case"rejected":return s.jsx(m,{variant:"outline",className:"bg-red-50 text-red-700 border-red-200",children:"Rejected"});default:return s.jsx(m,{variant:"outline",children:e})}};return s.jsxs(o,{children:[s.jsxs("div",{className:"container mx-auto",children:[s.jsxs("div",{className:"mb-6 flex flex-col md:flex-row md:items-center md:justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Apologist Scholar Applications"}),s.jsx("p",{className:"text-gray-500",children:"Review and manage applications"})]}),s.jsxs("div",{className:"mt-4 flex items-center space-x-2 md:mt-0",children:[s.jsxs("div",{className:"relative flex-1 md:w-64",children:[s.jsx(z,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-400"}),s.jsx(l,{placeholder:"Search by name or email",className:"pl-8",value:Y,onChange:e=>G(e.target.value)})]}),s.jsxs(F,{value:Q,onValueChange:Z,children:[s.jsx(P,{className:"w-[140px]",children:s.jsx(T,{placeholder:"Status"})}),s.jsx(O,{children:s.jsxs(I,{children:[s.jsx(B,{children:"Status"}),s.jsx(D,{value:"all",children:"All"}),s.jsx(D,{value:"pending",children:"Pending"}),s.jsx(D,{value:"approved",children:"Approved"}),s.jsx(D,{value:"rejected",children:"Rejected"})]})})]})]})]}),s.jsxs(h,{defaultValue:"all",className:"mb-8",children:[s.jsxs(j,{children:[s.jsx(p,{value:"all",children:"All Applications"}),s.jsx(p,{value:"pending",children:"Pending"}),s.jsx(p,{value:"approved",children:"Approved"}),s.jsx(p,{value:"rejected",children:"Rejected"})]}),s.jsx(u,{value:"all",className:"mt-4",children:ue(oe)}),s.jsx(u,{value:"pending",className:"mt-4",children:ue(ne.filter(e=>"pending"===e.status))}),s.jsx(u,{value:"approved",className:"mt-4",children:ue(ne.filter(e=>"approved"===e.status))}),s.jsx(u,{value:"rejected",className:"mt-4",children:ue(ne.filter(e=>"rejected"===e.status))})]})]}),s.jsx(N,{open:se,onOpenChange:ae,children:s.jsxs(v,{className:"sm:max-w-[600px]",children:[s.jsxs(f,{children:[s.jsx(g,{children:"Review Apologist Scholar Application"}),s.jsx(w,{children:"Review and update the status of this application."})]}),s.jsxs("div",{className:"grid gap-4 py-4",children:[s.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[s.jsx(b,{className:"text-right",children:"Applicant"}),s.jsxs("div",{className:"col-span-3 flex items-center space-x-2",children:[s.jsx(r,{children:s.jsx(d,{children:ie?.fullName.charAt(0)||"A"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:ie?.fullName}),s.jsx("p",{className:"text-sm text-gray-500",children:ie?.user?.email})]})]})]}),s.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[s.jsx(b,{className:"text-right",children:"Status"}),s.jsxs(F,{value:de,onValueChange:e=>ce(e),children:[s.jsx(P,{className:"col-span-3",children:s.jsx(T,{placeholder:"Select status"})}),s.jsxs(O,{children:[s.jsx(D,{value:"approved",children:"Approve"}),s.jsx(D,{value:"rejected",children:"Reject"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-4 items-start gap-4",children:[s.jsx(b,{className:"text-right",htmlFor:"reviewNotes",children:"Review Notes"}),s.jsx(A,{id:"reviewNotes",className:"col-span-3",placeholder:"Add notes about your decision...",value:le,onChange:e=>re(e.target.value)})]})]}),s.jsxs(y,{children:[s.jsx(c,{variant:"outline",onClick:()=>ae(!1),children:"Cancel"}),s.jsx(c,{onClick:async()=>{if(ie)try{if(!(await fetch(`/api/admin/apologist-scholar-applications/${ie.id}/review`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:de,reviewNotes:le,reviewedBy:U?.id})})).ok)throw new Error("Failed to submit review");await xe(),ae(!1),n({title:"Review submitted",description:`Application has been ${de}.`})}catch(e){n({title:"Error",description:"Failed to submit review. Please try again.",variant:"destructive"})}},children:"Submit Review"})]})]})})]});function ue(e){return me?s.jsx("div",{className:"flex justify-center py-10",children:s.jsx(q,{className:"h-8 w-8 animate-spin text-primary"})}):0===e.length?s.jsxs("div",{className:"flex flex-col items-center justify-center rounded-lg border border-dashed py-10 text-center",children:[s.jsx(K,{className:"mb-2 h-10 w-10 text-gray-400"}),s.jsx("h3",{className:"text-lg font-medium",children:"No applications found"}),s.jsx("p",{className:"max-w-md text-sm text-gray-500",children:"There are no apologist scholar applications matching your criteria."})]}):s.jsx("div",{className:"rounded-md border",children:s.jsxs(C,{children:[s.jsx(S,{children:s.jsxs(R,{children:[s.jsx(E,{className:"w-auto",children:"Applicant"}),s.jsx(E,{className:"w-auto",children:"Expertise Areas"}),s.jsx(E,{className:"w-auto",children:"Date"}),s.jsx(E,{className:"w-auto",children:"Status"}),s.jsx(E,{className:"w-auto text-right",children:"Actions"})]})}),s.jsx(k,{children:e.map(e=>s.jsxs(a.Fragment,{children:[s.jsxs(R,{children:[s.jsx(L,{className:"font-medium",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(r,{className:"h-8 w-8",children:s.jsx(d,{children:e.fullName.charAt(0)})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:e.fullName}),s.jsx("div",{className:"text-sm text-gray-500",children:e.user?.email})]})]})}),s.jsx(L,{children:s.jsx("span",{className:"line-clamp-1",children:e.areasOfExpertise})}),s.jsx(L,{children:s.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[s.jsx(V,{className:"h-3.5 w-3.5"}),s.jsx("span",{children:je(e.submittedAt)})]})}),s.jsx(L,{children:s.jsx(pe,{status:e.status})}),s.jsx(L,{className:"text-right",children:s.jsxs("div",{className:"flex justify-end space-x-1",children:[s.jsxs(c,{variant:"ghost",size:"sm",onClick:()=>{return s=e.id,void ee(_===s?null:s);var s},children:[_===e.id?s.jsx(W,{className:"h-4 w-4"}):s.jsx(J,{className:"h-4 w-4"}),"Details"]}),s.jsx(c,{variant:"outline",size:"sm",onClick:()=>he(e),children:"Review"})]})})]}),_===e.id&&s.jsx(R,{className:"bg-gray-50",children:s.jsx(L,{colSpan:5,className:"p-4",children:s.jsxs("div",{className:"rounded-md border bg-white p-4",children:[s.jsxs("div",{className:"mb-4 grid gap-4 md:grid-cols-2",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold",children:"Personal Information"}),s.jsx(M,{className:"my-2"}),s.jsxs("dl",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("dt",{className:"font-medium text-gray-500",children:"Full Name:"}),s.jsx("dd",{children:e.fullName})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("dt",{className:"font-medium text-gray-500",children:"Email:"}),s.jsx("dd",{children:e.user?.email})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("dt",{className:"font-medium text-gray-500",children:"Social Media:"}),s.jsx("dd",{children:e.onlineSocialHandles||"None provided"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("dt",{className:"font-medium text-gray-500",children:"Time Commitment:"}),s.jsx("dd",{children:e.weeklyTimeCommitment})]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold",children:"References"}),s.jsx(M,{className:"my-2"}),s.jsxs("dl",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("dt",{className:"font-medium text-gray-500",children:"Reference Name:"}),s.jsx("dd",{children:e.referenceName})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("dt",{className:"font-medium text-gray-500",children:"Contact:"}),s.jsx("dd",{children:e.referenceContact})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("dt",{className:"font-medium text-gray-500",children:"Institution:"}),s.jsx("dd",{children:e.referenceInstitution})]})]})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"font-semibold",children:"Academic Background & Expertise"}),s.jsx(M,{className:"my-2"}),s.jsxs("dl",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("dt",{className:"font-medium text-gray-500",children:"Academic Credentials:"}),s.jsx("dd",{className:"mt-1 whitespace-pre-wrap text-sm",children:e.academicCredentials})]}),s.jsxs("div",{children:[s.jsx("dt",{className:"font-medium text-gray-500",children:"Educational Background:"}),s.jsx("dd",{className:"mt-1 whitespace-pre-wrap text-sm",children:e.educationalBackground})]}),s.jsxs("div",{children:[s.jsx("dt",{className:"font-medium text-gray-500",children:"Areas of Expertise:"}),s.jsx("dd",{className:"mt-1 whitespace-pre-wrap text-sm",children:e.areasOfExpertise})]}),s.jsxs("div",{children:[s.jsx("dt",{className:"font-medium text-gray-500",children:"Published Works:"}),s.jsx("dd",{className:"mt-1 whitespace-pre-wrap text-sm",children:e.publishedWorks||"None provided"})]})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"font-semibold",children:"Theological Perspective"}),s.jsx(M,{className:"my-2"}),s.jsxs("dl",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("dt",{className:"font-medium text-gray-500",children:"Theological Perspective:"}),s.jsx("dd",{className:"mt-1 whitespace-pre-wrap text-sm",children:e.theologicalPerspective})]}),s.jsxs("div",{children:[s.jsx("dt",{className:"font-medium text-gray-500",children:"Statement of Faith:"}),s.jsx("dd",{className:"mt-1 whitespace-pre-wrap text-sm",children:e.statementOfFaith})]})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"font-semibold",children:"Experience & Motivation"}),s.jsx(M,{className:"my-2"}),s.jsxs("dl",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("dt",{className:"font-medium text-gray-500",children:"Prior Apologetics Experience:"}),s.jsx("dd",{className:"mt-1 whitespace-pre-wrap text-sm",children:e.priorApologeticsExperience})]}),s.jsxs("div",{children:[s.jsx("dt",{className:"font-medium text-gray-500",children:"Writing Sample:"}),s.jsx("dd",{className:"mt-1 whitespace-pre-wrap text-sm",children:e.writingSample})]}),s.jsxs("div",{children:[s.jsx("dt",{className:"font-medium text-gray-500",children:"Motivation:"}),s.jsx("dd",{className:"mt-1 whitespace-pre-wrap text-sm",children:e.motivation})]})]})]}),("pending"!==e.status||e.reviewNotes)&&s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold",children:"Review Information"}),s.jsx(M,{className:"my-2"}),s.jsxs("dl",{className:"space-y-2",children:[e.reviewedAt&&s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsx("dt",{className:"font-medium text-gray-500",children:"Reviewed On:"}),s.jsx("dd",{children:je(e.reviewedAt)})]}),e.reviewNotes&&s.jsxs("div",{children:[s.jsx("dt",{className:"font-medium text-gray-500",children:"Review Notes:"}),s.jsx("dd",{className:"mt-1 whitespace-pre-wrap rounded-md bg-gray-50 p-2 text-sm",children:e.reviewNotes})]})]})]}),s.jsx("div",{className:"mt-4 flex justify-end",children:s.jsx(c,{variant:"default",size:"sm",onClick:()=>he(e),children:"pending"===e.status?"Review":"Update Review"})})]})})})]},e.id))})]})})}}export{U as default};
