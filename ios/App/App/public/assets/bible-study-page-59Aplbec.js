import{r as e,j as s,i as a,k as r}from"./vendor-radix-Cb0-vzxO.js";import{c as n,a as t,u as i}from"./vendor-query-qkAKzVJ0.js";import{T as d,a as l,b as c,c as o}from"./tabs-N8_zO4xm.js";import{m,h as x,i as h,C as u,a as j,B as p,S as g,x as N,z as f,E as y,F as b,u as v,g as w,b as P,f as S,j as k,G as A}from"./index-CQmKbNyS.js";import{C}from"./checkbox-BNsZ7Wa0.js";import{c as D,f as R,C as I,s as Y,z as T,av as F,p as q,a as z,P as E,n as O,aw as M}from"./vendor-icons-CM8Yk8yJ.js";import"./vendor-react-eVk5PToZ.js";import"./vendor-utils-nlnd1Dju.js";var $="Progress",[B]=a($),[J,L]=B($),V=e.forwardRef((e,a)=>{const{__scopeProgress:n,value:t=null,max:i,getValueLabel:d=G,...l}=e;(i||0===i)&&W(i);const c=W(i)?i:100;null!==t&&X(t,c);const o=X(t,c)?t:null,m=U(o)?d(o,c):void 0;return s.jsx(J,{scope:n,value:o,max:c,children:s.jsx(r.div,{"aria-valuemax":c,"aria-valuemin":0,"aria-valuenow":U(o)?o:void 0,"aria-valuetext":m,role:"progressbar","data-state":Q(o,c),"data-value":o??void 0,"data-max":c,...l,ref:a})})});V.displayName=$;var K="ProgressIndicator",_=e.forwardRef((e,a)=>{const{__scopeProgress:n,...t}=e,i=L(K,n);return s.jsx(r.div,{"data-state":Q(i.value,i.max),"data-value":i.value??void 0,"data-max":i.max,...t,ref:a})});function G(e,s){return`${Math.round(e/s*100)}%`}function Q(e,s){return null==e?"indeterminate":e===s?"complete":"loading"}function U(e){return"number"==typeof e}function W(e){return U(e)&&!isNaN(e)&&e>0}function X(e,s){return U(e)&&!isNaN(e)&&e<=s&&e>=0}_.displayName=K;var H=V,Z=_;const ee=e.forwardRef(({className:e,value:a,...r},n)=>s.jsx(H,{ref:n,className:m("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...r,children:s.jsx(Z,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(a||0)}%)`}})}));function se({plan:a,progress:r,isAuthenticated:i}){const[d,l]=e.useState(!1),c=n(),{toast:o}=x(),m=t({mutationFn:async()=>{const e=await h("POST","/api/bible-reading-progress",{planId:a.id});return await e.json()},onSuccess:()=>{c.invalidateQueries({queryKey:["/api/bible-reading-progress"]}),o({title:"Success",description:"You've joined this reading plan. Start reading today!"})},onError:e=>{o({title:"Error",description:`Failed to join plan: ${e.message}`,variant:"destructive"})}}),v=t({mutationFn:async e=>{const s=await h("POST","/api/bible-reading-progress/mark-completed",{planId:a.id,day:e});return await s.json()},onSuccess:()=>{c.invalidateQueries({queryKey:["/api/bible-reading-progress"]}),o({title:"Well done!",description:"You've completed today's reading"})},onError:e=>{o({title:"Error",description:`Failed to mark as complete: ${e.message}`,variant:"destructive"})}}),w=r?.currentDay||0,P=r?.completedDays||[],S=a.duration>0?Math.floor(P.length/a.duration*100):0,k=!!r,A=r&&!r.completedAt,T=a.readings.find(e=>e.day===w);return s.jsxs(s.Fragment,{children:[s.jsx(u,{className:"mb-4 touch-manipulation border rounded-xl active:bg-secondary/5 transition-colors duration-150 active-scale",onClick:()=>l(!0),children:s.jsxs(j,{className:"p-4",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("h3",{className:"font-semibold line-clamp-1",children:a.title}),s.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[s.jsx(D,{className:"h-3.5 w-3.5 mr-1.5 inline"}),s.jsxs("span",{children:[a.duration," days"]})]}),s.jsxs("div",{className:"flex items-center text-sm text-muted-foreground mt-0.5",children:[s.jsx(R,{className:"h-3.5 w-3.5 mr-1.5 inline"}),s.jsxs("span",{children:[a.readings.length," readings"]})]})]}),s.jsx(I,{className:"h-5 w-5 text-muted-foreground"})]}),k&&s.jsxs("div",{className:"mt-3",children:[s.jsxs("div",{className:"flex justify-between items-center mb-1 text-xs",children:[s.jsx("span",{children:"Progress"}),s.jsxs("span",{className:"font-medium",children:[S,"%"]})]}),s.jsx(ee,{value:S,className:"h-1.5"}),A&&T&&s.jsxs("div",{className:"mt-3 pt-3 border-t border-dashed border-secondary/20",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-sm font-medium",children:"Today's reading:"}),s.jsxs("span",{className:"text-xs text-muted-foreground",children:["Day ",w]})]}),s.jsx("p",{className:"text-xs mt-1 line-clamp-1",children:T.passages.join(", ")}),s.jsx("div",{className:"flex justify-end mt-2",children:s.jsxs(p,{size:"sm",variant:"outline",className:"h-8 text-xs rounded-full px-3 touch-target active-scale",onClick:e=>{e.stopPropagation(),v.mutate(w)},disabled:v.isPending,children:[s.jsx(Y,{className:"h-3.5 w-3.5 mr-1.5"}),"Mark as read"]})})]})]})]})}),s.jsx(g,{open:d,onOpenChange:l,children:s.jsxs(N,{side:"bottom",className:"h-[80vh] pt-6 rounded-t-3xl",children:[s.jsxs(f,{children:[s.jsx(y,{className:"text-xl",children:a.title}),s.jsx(b,{className:"line-clamp-3",children:a.description})]}),s.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("div",{className:"flex items-center text-sm",children:[s.jsx(D,{className:"h-4 w-4 mr-1.5"}),s.jsxs("span",{children:[a.duration," days"]})]}),s.jsxs("div",{className:"flex items-center text-sm mt-1",children:[s.jsx(R,{className:"h-4 w-4 mr-1.5"}),s.jsxs("span",{children:[a.readings.length," readings"]})]})]}),!k&&i&&s.jsx(p,{onClick:()=>m.mutate(),disabled:m.isPending,size:"sm",className:"rounded-full px-4 h-9 touch-target active-scale",children:"Join Plan"})]}),k&&s.jsxs("div",{className:"mt-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-1 text-sm",children:[s.jsx("span",{children:"Your progress"}),s.jsxs("span",{children:[P.length," of ",a.duration," days"]})]}),s.jsx(ee,{value:S,className:"h-2"}),s.jsxs("div",{className:"mt-6",children:[s.jsx("h4",{className:"text-base font-medium mb-3",children:"Reading Schedule"}),s.jsx("div",{className:"max-h-[40vh] overflow-y-auto pr-2",children:a.readings.map((e,a)=>{const r=P.includes(e.day),n=e.day===w;return s.jsxs("div",{className:`py-2 px-3 mb-2 rounded-lg border flex items-center gap-3\n                          ${r?"bg-secondary/10 border-secondary/20":"border-border"}\n                          ${n?"border-primary/50":""}\n                          transition-colors duration-150 active:bg-secondary/5\n                        `,children:[s.jsx(C,{checked:r,onCheckedChange:()=>{!r&&i&&v.mutate(e.day)},className:"h-5 w-5 rounded touch-target",disabled:!i||v.isPending}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"font-medium text-sm",children:e.title||`Day ${e.day}`}),n&&s.jsx("span",{className:"text-xs px-2 py-0.5 bg-primary/10 text-primary rounded font-medium",children:"Today"})]}),s.jsx("p",{className:"text-xs text-muted-foreground mt-0.5 line-clamp-1",children:e.passages.join(", ")})]})]},a)})})]})]})]})})]})}ee.displayName=H.displayName;const ae=()=>{const{user:a}=v(),{toast:r}=x(),[n,t]=e.useState("reading-plans"),m=w("(max-width: 768px)"),{data:h,isLoading:g}=i({queryKey:["/api/bible-reading-plans"],queryFn:()=>fetch("/api/bible-reading-plans").then(e=>e.json()),enabled:"reading-plans"===n}),N=Array.isArray(h)?h.map(e=>({...e,readings:"string"==typeof e.readings?JSON.parse(e.readings):e.readings})):[],{data:f,isLoading:y}=i({queryKey:["/api/bible-reading-progress",a?.id],queryFn:()=>fetch("/api/bible-reading-progress").then(e=>e.json()),enabled:!!a&&"reading-plans"===n}),b=Array.isArray(f)?f.map(e=>({...e,completedDays:"string"==typeof e.completedDays?JSON.parse(e.completedDays):Array.isArray(e.completedDays)?e.completedDays:[]})):[],{data:C,isLoading:I}=i({queryKey:["/api/bible-study-notes"],queryFn:()=>fetch("/api/bible-study-notes").then(e=>e.json()),enabled:!!a&&"notes"===n}),Y=Array.isArray(C)?C:[];return s.jsxs("div",{className:"container py-6",children:[s.jsxs("div",{className:""+(m?"mb-4":"mb-6"),children:[s.jsxs("h1",{className:(m?"text-2xl":"text-3xl")+" font-bold flex items-center",children:[s.jsx(T,{className:""+(m?"mr-2 h-5 w-5":"mr-3 h-6 w-6")})," Bible Study"]}),!m&&s.jsx("p",{className:"text-muted-foreground mt-1",children:"Read, study and memorize Scripture with tools designed to deepen your understanding"})]}),s.jsxs(d,{defaultValue:"reading-plans",onValueChange:t,children:[s.jsxs(l,{className:"mb-6 "+(m?"grid grid-cols-3 w-full":""),children:[s.jsxs(c,{value:"reading-plans",className:"flex items-center",children:[s.jsx(R,{className:"h-4 w-4 mr-2"}),s.jsx("span",{children:"Reading Plans"})]}),s.jsxs(c,{value:"notes",className:"flex items-center",children:[s.jsx(F,{className:"h-4 w-4 mr-2"}),s.jsx("span",{children:"Notes"})]}),s.jsxs(c,{value:"verses",className:"flex items-center",children:[s.jsx(q,{className:"h-4 w-4 mr-2"}),s.jsx("span",{children:"Memorize"})]})]}),s.jsx(o,{value:"reading-plans",children:g?s.jsx("div",{className:"text-center py-8",children:"Loading reading plans..."}):m?s.jsxs("div",{children:[s.jsxs("div",{className:"mb-4 mt-1",children:[s.jsx("h2",{className:"text-xl font-semibold mb-1",children:"Your Reading Plans"}),a?b&&b.length>0?s.jsx("div",{children:b.map(e=>{const r=N.find(s=>s.id===e.planId);return r?s.jsx(se,{plan:r,progress:e,isAuthenticated:!!a},e.planId):null})}):s.jsxs("div",{className:"text-muted-foreground text-center py-8 border rounded-lg mb-4",children:[s.jsx(R,{className:"w-12 h-12 mx-auto mb-2 opacity-30"}),s.jsx("p",{children:"You haven't joined any reading plans yet."}),s.jsx("p",{className:"text-sm",children:"Browse available plans below."})]}):s.jsx("div",{className:"text-muted-foreground text-center py-8 border rounded-lg mb-4",children:s.jsx("p",{children:"Sign in to track your Bible reading progress"})})]}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold mb-3",children:"Available Reading Plans"}),s.jsx("div",{children:N.map(e=>{const r=b?.find(s=>s.planId===e.id);return s.jsx(se,{plan:e,progress:r,isAuthenticated:!!a},e.id)})})]})]}):s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Your Reading Plans"}),a?b&&b.length>0?s.jsx("div",{className:"space-y-6",children:b.map(e=>{const n=N.find(s=>s.id===e.planId);if(!n)return null;const t=Math.floor(e.completedDays.length/n.duration*100),i=n.readings.find(s=>s.day===e.currentDay);return s.jsxs(u,{children:[s.jsxs(P,{children:[s.jsx(S,{children:n.title}),s.jsx(k,{children:n.description})]}),s.jsxs(j,{children:[s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"flex justify-between mb-1",children:[s.jsx("span",{className:"text-sm font-medium",children:"Progress"}),s.jsxs("span",{className:"text-sm text-muted-foreground",children:[t,"%"]})]}),s.jsx(ee,{value:t,className:"h-2"})]}),i&&!e.completedAt&&s.jsxs("div",{className:"mt-4 p-4 border rounded-lg bg-secondary/5",children:[s.jsxs("h4",{className:"font-medium flex items-center",children:[s.jsx(R,{className:"h-4 w-4 mr-2"}),"Today's Reading (Day ",e.currentDay,")"]}),s.jsx("p",{className:"my-2 text-sm",children:i.passages.join(", ")}),s.jsxs(p,{size:"sm",className:"mt-2",onClick:()=>(async(e,s)=>{if(a)try{if(!(await fetch("/api/bible-reading-progress/mark-completed",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({planId:e,day:s})})).ok)throw new Error("Failed to mark reading as completed");r({title:"Great job!",description:"Reading marked as completed"}),window.location.reload()}catch(n){r({title:"Error",description:n.message,variant:"destructive"})}})(n.id,e.currentDay),children:[s.jsx(z,{className:"mr-2 h-4 w-4"})," Mark as Completed"]})]}),e.completedAt&&s.jsxs("div",{className:"p-4 border rounded-lg bg-green-50 text-green-800",children:[s.jsxs("h4",{className:"font-medium flex items-center",children:[s.jsx(z,{className:"h-4 w-4 mr-2"}),"Plan Completed!"]}),s.jsxs("p",{className:"text-sm mt-2",children:["Completed on ",A(new Date(e.completedAt))]})]})]})]},e.planId)})}):s.jsx(u,{className:"border-dashed",children:s.jsxs(j,{className:"pt-6 text-center",children:[s.jsx(R,{className:"w-12 h-12 mx-auto mb-3 text-muted-foreground opacity-50"}),s.jsx("h3",{className:"text-lg font-medium mb-2",children:"No Reading Plans Yet"}),s.jsx("p",{className:"text-muted-foreground mb-4",children:"You haven't joined any reading plans yet. Explore the available plans and start your Bible reading journey today."})]})}):s.jsx(u,{className:"border-dashed",children:s.jsxs(j,{className:"pt-6 text-center",children:[s.jsx("h3",{className:"text-lg font-medium mb-2",children:"Sign In to Track Progress"}),s.jsx("p",{className:"text-muted-foreground",children:"Sign in to join reading plans and track your progress."})]})})]}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Available Reading Plans"}),s.jsx("div",{className:"space-y-6",children:N.map(e=>{const n=b?.some(s=>s.planId===e.id);return s.jsxs(u,{children:[s.jsxs(P,{children:[s.jsx(S,{children:e.title}),s.jsx(k,{children:e.description})]}),s.jsxs(j,{children:[s.jsxs("div",{className:"flex justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(D,{className:"h-4 w-4 mr-2 text-muted-foreground"}),s.jsxs("span",{className:"text-sm text-muted-foreground",children:[e.duration," days"]})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx(R,{className:"h-4 w-4 mr-2 text-muted-foreground"}),s.jsxs("span",{className:"text-sm text-muted-foreground",children:[e.readings.length," readings"]})]})]}),a&&!n&&s.jsx(p,{onClick:()=>(async e=>{if(a)try{if(!(await fetch("/api/bible-reading-progress",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({planId:e})})).ok)throw new Error("Failed to join reading plan");r({title:"Success!",description:"You've joined the reading plan"}),window.location.reload()}catch(s){r({title:"Error",description:s.message,variant:"destructive"})}else r({title:"Authentication Required",description:"Please sign in to join a reading plan",variant:"destructive"})})(e.id),children:"Join Plan"}),n&&s.jsx("div",{className:"bg-secondary/10 text-secondary-foreground py-2 px-4 rounded-md text-sm",children:"You've already joined this plan"})]})]},e.id)})})]})]})}),s.jsx(o,{value:"notes",children:I?s.jsx("div",{className:"text-center py-8",children:"Loading notes..."}):a?s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("h2",{className:"text-2xl font-semibold",children:"Your Study Notes"}),s.jsxs(p,{children:[s.jsx(E,{className:"mr-2 h-4 w-4"})," New Note"]})]}),0===Y.length?s.jsx(u,{className:"border-dashed",children:s.jsxs(j,{className:"pt-6 text-center",children:[s.jsx(F,{className:"w-12 h-12 mx-auto mb-3 text-muted-foreground opacity-50"}),s.jsx("h3",{className:"text-lg font-medium mb-2",children:"No Notes Yet"}),s.jsx("p",{className:"text-muted-foreground mb-4",children:"You haven't created any study notes yet. Start adding notes to deepen your understanding."})]})}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Y.map(e=>s.jsxs(u,{children:[s.jsxs(P,{className:"pb-2",children:[s.jsx(S,{className:"text-xl",children:e.title}),e.passage&&s.jsx(k,{children:e.passage})]}),s.jsxs(j,{children:[s.jsx("p",{className:"text-sm mb-4 line-clamp-3",children:e.content}),s.jsxs("div",{className:"flex justify-between items-center text-xs text-muted-foreground",children:[s.jsx("span",{children:A(new Date(e.createdAt||new Date))}),e.isPublic?s.jsxs("span",{className:"flex items-center",children:[s.jsx(O,{className:"h-3 w-3 mr-1"})," Public"]}):s.jsxs("span",{className:"flex items-center",children:[s.jsx(q,{className:"h-3 w-3 mr-1"})," Private"]})]})]})]},e.id))})]}):s.jsx(u,{className:"border-dashed",children:s.jsxs(j,{className:"pt-6 text-center",children:[s.jsx("h3",{className:"text-lg font-medium mb-2",children:"Sign In to Create Notes"}),s.jsx("p",{className:"text-muted-foreground",children:"Sign in to create and save your Bible study notes."})]})})}),s.jsx(o,{value:"verses",children:s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("h2",{className:"text-2xl font-semibold",children:"Verse Memorization"}),a&&s.jsxs(p,{children:[s.jsx(E,{className:"mr-2 h-4 w-4"})," Add Verse"]})]}),s.jsx(u,{className:"border-dashed",children:s.jsxs(j,{className:"pt-6 text-center",children:[s.jsx(M,{className:"w-12 h-12 mx-auto mb-3 text-muted-foreground opacity-50"}),s.jsx("h3",{className:"text-lg font-medium mb-2",children:"Verse Memorization Coming Soon"}),s.jsx("p",{className:"text-muted-foreground mb-4",children:"This feature is under development. Soon you'll be able to add verses to memorize and track your progress."})]})})]})})]})]})};export{ae as default};
