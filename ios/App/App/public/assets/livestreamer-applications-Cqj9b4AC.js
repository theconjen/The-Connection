import{r as e,j as s}from"./vendor-radix-Cb0-vzxO.js";import{c as a,u as i,a as r}from"./vendor-query-qkAKzVJ0.js";import{u as t,h as l,n,B as c,c as d,C as m,b as o,A as p,d as x,e as h,f as j,j as u,a as N,k as v,i as g}from"./index-CQmKbNyS.js";import{A as f}from"./admin-layout-DGdpTm_4.js";import{T as b}from"./textarea-BQP-18ak.js";import{S as w}from"./separator-BRrBbODb.js";import{D as y,b as A,c as S,d as C,e as F,f as P}from"./dialog-BfqlROKo.js";import{T as k,a as U,b as R,c as q}from"./tabs-N8_zO4xm.js";import{A as D,q as E,X as L,a as O}from"./vendor-icons-CM8Yk8yJ.js";import"./vendor-react-eVk5PToZ.js";import"./vendor-utils-nlnd1Dju.js";function T(){const{isAuthenticated:T}=t(),[K,V]=e.useState(""),[z,B]=e.useState(null),[J,Q]=e.useState("pending"),[$,W]=e.useState(!1),{toast:X}=l(),Y=a(),{data:G,isLoading:H}=i({queryKey:["/api/admin/applications/livestreamer"],retry:!1,enabled:T}),I=r({mutationFn:async e=>g(`/api/admin/applications/livestreamer/${e}/approve`,{method:"POST",body:JSON.stringify({reviewNotes:K})}),onSuccess:()=>{Y.invalidateQueries({queryKey:["/api/admin/applications/livestreamer"]}),X({title:"Application approved",description:"The livestreamer application has been approved successfully."}),W(!1),V(""),B(null)},onError:e=>{X({title:"Error",description:"Failed to approve the application. Please try again.",variant:"destructive"})}}),M=r({mutationFn:async e=>g(`/api/admin/applications/livestreamer/${e}/reject`,{method:"POST",body:JSON.stringify({reviewNotes:K})}),onSuccess:()=>{Y.invalidateQueries({queryKey:["/api/admin/applications/livestreamer"]}),X({title:"Application rejected",description:"The livestreamer application has been rejected."}),W(!1),V(""),B(null)},onError:e=>{X({title:"Error",description:"Failed to reject the application. Please try again.",variant:"destructive"})}});n();const Z=G?.filter(e=>"pending"===e.status)||[],_=G?.filter(e=>"pending"!==e.status)||[],ee=e=>{B(e),W(!0)},se=G?.find(e=>e.id===z);return s.jsxs(f,{children:[s.jsxs("div",{className:"mb-6 flex items-center",children:[s.jsxs(c,{variant:"ghost",className:"mr-2",onClick:()=>window.history.back(),children:[s.jsx(D,{className:"mr-2 h-4 w-4"}),"Back"]}),s.jsx("h1",{className:"text-3xl font-bold",children:"Livestreamer Applications"})]}),s.jsxs(k,{defaultValue:"pending",value:J,onValueChange:Q,children:[s.jsxs(U,{className:"mb-6",children:[s.jsxs(R,{value:"pending",children:["Pending",Z.length>0&&s.jsx(d,{variant:"secondary",className:"ml-2",children:Z.length})]}),s.jsx(R,{value:"processed",children:"Processed"})]}),s.jsx(q,{value:"pending",children:H?s.jsx("div",{className:"flex h-40 items-center justify-center",children:s.jsx(E,{className:"h-8 w-8 animate-spin text-primary"})}):0===Z.length?s.jsxs("div",{className:"flex h-40 flex-col items-center justify-center rounded-lg border border-dashed p-8 text-center",children:[s.jsx("p",{className:"text-lg text-gray-500",children:"No pending applications"}),s.jsx("p",{className:"text-sm text-gray-400",children:"When users apply to become livestreamers, their applications will appear here."})]}):s.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:Z.map(e=>s.jsxs(m,{className:"overflow-hidden",children:[s.jsx(o,{className:"pb-2",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(p,{className:"mr-2 h-8 w-8",children:e.user?.avatarUrl?s.jsx(x,{src:e.user.avatarUrl,alt:e.user.username}):s.jsx(h,{children:e.user?.username.charAt(0).toUpperCase()})}),s.jsxs("div",{children:[s.jsx(j,{className:"text-lg",children:e.user?.displayName||e.user?.username}),s.jsxs(u,{className:"text-xs",children:["@",e.user?.username]})]})]})}),s.jsxs(N,{className:"pb-3",children:[s.jsx("p",{className:"line-clamp-3 text-sm text-gray-600",children:e.content}),s.jsxs("div",{className:"mt-3 text-xs text-gray-400",children:["Applied ",new Date(e.createdAt).toLocaleDateString()]})]}),s.jsx(v,{className:"pt-0",children:s.jsx(c,{onClick:()=>ee(e.id),className:"w-full",variant:"outline",children:"Review Application"})})]},e.id))})}),s.jsx(q,{value:"processed",children:H?s.jsx("div",{className:"flex h-40 items-center justify-center",children:s.jsx(E,{className:"h-8 w-8 animate-spin text-primary"})}):0===_.length?s.jsxs("div",{className:"flex h-40 flex-col items-center justify-center rounded-lg border border-dashed p-8 text-center",children:[s.jsx("p",{className:"text-lg text-gray-500",children:"No processed applications"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Applications that have been approved or rejected will appear here."})]}):s.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:_.map(e=>s.jsxs(m,{className:"overflow-hidden",children:[s.jsx(o,{className:"pb-2",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(p,{className:"mr-2 h-8 w-8",children:e.user?.avatarUrl?s.jsx(x,{src:e.user.avatarUrl,alt:e.user.username}):s.jsx(h,{children:e.user?.username.charAt(0).toUpperCase()})}),s.jsxs("div",{children:[s.jsx(j,{className:"text-lg",children:e.user?.displayName||e.user?.username}),s.jsxs(u,{className:"text-xs",children:["@",e.user?.username]})]})]}),s.jsx(d,{variant:"approved"===e.status?"success":"destructive",className:"capitalize",children:e.status})]})}),s.jsxs(N,{className:"pb-3",children:[s.jsx("p",{className:"line-clamp-3 text-sm text-gray-600",children:e.content}),e.reviewNotes&&s.jsxs("div",{className:"mt-2 rounded bg-gray-50 p-2 text-sm",children:[s.jsx("p",{className:"font-semibold text-gray-600",children:"Review Notes:"}),s.jsx("p",{className:"text-gray-500",children:e.reviewNotes})]}),s.jsxs("div",{className:"mt-3 text-xs text-gray-400",children:["Processed ",new Date(e.updatedAt||"").toLocaleDateString()]})]}),s.jsx(v,{className:"pt-0",children:s.jsx(c,{onClick:()=>ee(e.id),className:"w-full",variant:"outline",children:"View Details"})})]},e.id))})})]}),s.jsx(y,{open:$,onOpenChange:W,children:s.jsx(A,{className:"max-h-[90vh] max-w-3xl overflow-y-auto",children:se&&s.jsxs(s.Fragment,{children:[s.jsxs(S,{children:[s.jsx(C,{children:"Livestreamer Application Review"}),s.jsxs(F,{children:["Review application from ",se.user?.displayName||se.user?.username]})]}),s.jsxs("div",{className:"mt-4 grid gap-6 md:grid-cols-2",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center mb-4",children:[s.jsx(p,{className:"mr-2 h-10 w-10",children:se.user?.avatarUrl?s.jsx(x,{src:se.user.avatarUrl,alt:se.user.username}):s.jsx(h,{children:se.user?.username.charAt(0).toUpperCase()})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold",children:se.user?.displayName||se.user?.username}),s.jsxs("p",{className:"text-sm text-gray-500",children:["@",se.user?.username]})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"font-semibold",children:"Email"}),s.jsx("p",{className:"text-sm",children:se.user?.email})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"font-semibold",children:"Applied On"}),s.jsx("p",{className:"text-sm",children:new Date(se.createdAt).toLocaleString()})]}),"pending"!==se.status&&s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"font-semibold",children:"Status"}),s.jsx(d,{variant:"approved"===se.status?"success":"destructive",className:"mt-1 capitalize",children:se.status})]}),se.reviewNotes&&s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"font-semibold",children:"Review Notes"}),s.jsx("p",{className:"text-sm",children:se.reviewNotes})]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"font-semibold",children:"Stream Content"}),s.jsx("p",{className:"text-sm whitespace-pre-wrap",children:se.content})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"font-semibold",children:"Experience"}),s.jsx("p",{className:"text-sm whitespace-pre-wrap",children:se.experience})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"font-semibold",children:"Equipment"}),s.jsx("p",{className:"text-sm whitespace-pre-wrap",children:se.equipment})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"font-semibold",children:"Schedule"}),s.jsx("p",{className:"text-sm whitespace-pre-wrap",children:se.schedule})]})]})]}),s.jsx(w,{className:"my-4"}),"pending"===se.status&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{htmlFor:"reviewNotes",className:"mb-2 block font-medium",children:"Review Notes (will be sent to applicant)"}),s.jsx(b,{id:"reviewNotes",placeholder:"Add your feedback, comments, or instructions for the applicant...",value:K,onChange:e=>V(e.target.value),rows:4})]}),s.jsxs(P,{className:"flex justify-between sm:justify-between",children:[s.jsx(c,{type:"button",variant:"destructive",onClick:()=>{z&&M.mutate(z)},disabled:M.isPending,children:M.isPending?s.jsxs(s.Fragment,{children:[s.jsx(E,{className:"mr-2 h-4 w-4 animate-spin"}),"Rejecting..."]}):s.jsxs(s.Fragment,{children:[s.jsx(L,{className:"mr-2 h-4 w-4"}),"Reject Application"]})}),s.jsx(c,{type:"button",onClick:()=>{z&&I.mutate(z)},disabled:I.isPending,children:I.isPending?s.jsxs(s.Fragment,{children:[s.jsx(E,{className:"mr-2 h-4 w-4 animate-spin"}),"Approving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(O,{className:"mr-2 h-4 w-4"}),"Approve Application"]})})]})]})]})})})]})}export{T as default};
