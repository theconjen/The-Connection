import{r as e,j as s}from"./vendor-radix-Cb0-vzxO.js";import{c as a,a as i}from"./vendor-query-qkAKzVJ0.js";import{u as t,h as r,C as c,b as l,f as n,j as o,a as d,A as m,d as h,e as x,B as u,I as p,i as j}from"./index-CQmKbNyS.js";import{L as y}from"./label-BZLDYjV_.js";import{T as N}from"./textarea-BQP-18ak.js";import{T as v,a as f,b as g,c as w}from"./tabs-N8_zO4xm.js";import{S as b}from"./switch-DyT2ZBYr.js";import{aA as P,k as C,t as S,a4 as F,B as k}from"./vendor-icons-CM8Yk8yJ.js";import"./vendor-react-eVk5PToZ.js";import"./vendor-utils-nlnd1Dju.js";function E(){const{user:E,logout:z}=t(),{toast:A}=r(),I=a(),[L,U]=e.useState(!1),[T,D]=e.useState({displayName:"",bio:"",city:"",state:"",zipCode:"",email:""});e.useEffect(()=>{E&&D({displayName:E.displayName||"",bio:E.bio||"",city:E.city||"",state:E.state||"",zipCode:E.zipCode||"",email:E.email||""})},[E]);const[O,J]=e.useState({emailNotifications:!0,pushNotifications:!1,profileVisibility:"public",showLocation:!0,showInterests:!0}),[q,B]=e.useState({currentPassword:"",newPassword:"",confirmPassword:""}),Y=i({mutationFn:async e=>j(`/api/user/${E?.id}`,{method:"PATCH",body:JSON.stringify(e)}),onSuccess:()=>{I.invalidateQueries({queryKey:["/api/user"]}),A({title:"Success",description:"Profile updated successfully"})},onError:e=>{A({title:"Error",description:e.message||"Failed to update profile",variant:"destructive"})}}),Z=i({mutationFn:async e=>j("/api/user/change-password",{method:"POST",body:JSON.stringify(e)}),onSuccess:()=>{B({currentPassword:"",newPassword:"",confirmPassword:""}),A({title:"Success",description:"Password updated successfully"})},onError:e=>{A({title:"Error",description:e.message||"Failed to update password",variant:"destructive"})}});return E?s.jsxs("div",{className:"container mx-auto py-8 px-4 max-w-4xl",children:[s.jsxs("div",{className:"mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Account Settings"}),s.jsx("p",{className:"text-gray-600",children:"Manage your account preferences and security settings"})]}),s.jsxs(v,{defaultValue:"profile",className:"w-full",children:[s.jsxs(f,{className:"grid w-full grid-cols-5",children:[s.jsxs(g,{value:"profile",className:"flex items-center gap-2",children:[s.jsx(P,{className:"w-4 h-4"}),"Profile"]}),s.jsxs(g,{value:"notifications",className:"flex items-center gap-2",children:[s.jsx(C,{className:"w-4 h-4"}),"Notifications"]}),s.jsxs(g,{value:"privacy",className:"flex items-center gap-2",children:[s.jsx(S,{className:"w-4 h-4"}),"Privacy"]}),s.jsxs(g,{value:"security",className:"flex items-center gap-2",children:[s.jsx(F,{className:"w-4 h-4"}),"Security"]}),s.jsxs(g,{value:"organization",className:"flex items-center gap-2",children:[s.jsx(k,{className:"w-4 h-4"}),"Church"]})]}),s.jsx(w,{value:"profile",className:"space-y-6",children:s.jsxs(c,{children:[s.jsxs(l,{children:[s.jsxs(n,{className:"flex items-center gap-2",children:[s.jsx(P,{className:"w-5 h-5"}),"Profile Information"]}),s.jsx(o,{children:"Update your public profile information and location details"})]}),s.jsx(d,{children:s.jsxs("form",{onSubmit:async e=>{e.preventDefault(),U(!0);try{await Y.mutateAsync(T)}catch(s){}finally{U(!1)}},className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[s.jsxs(m,{className:"w-20 h-20",children:[s.jsx(h,{src:E.avatarUrl||void 0}),s.jsx(x,{className:"text-lg",children:E.displayName?.charAt(0)||E.username.charAt(0)})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-lg",children:E.displayName||E.username}),s.jsx("p",{className:"text-gray-600",children:E.email}),s.jsx(u,{variant:"outline",size:"sm",className:"mt-2",children:"Change Avatar"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(y,{htmlFor:"displayName",children:"Display Name"}),s.jsx(p,{id:"displayName",value:T.displayName,onChange:e=>D({...T,displayName:e.target.value}),placeholder:"Your display name"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(y,{htmlFor:"email",children:"Email"}),s.jsx(p,{id:"email",type:"email",value:T.email,onChange:e=>D({...T,email:e.target.value}),placeholder:"your@email.com"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(y,{htmlFor:"bio",children:"Bio"}),s.jsx(N,{id:"bio",value:T.bio,onChange:e=>D(s=>({...s,bio:e.target.value})),placeholder:"Tell others about yourself",rows:3})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(y,{htmlFor:"city",children:"City"}),s.jsx(p,{id:"city",value:T.city,onChange:e=>D(s=>({...s,city:e.target.value})),placeholder:"Your city"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(y,{htmlFor:"state",children:"State"}),s.jsx(p,{id:"state",value:T.state,onChange:e=>D(s=>({...s,state:e.target.value})),placeholder:"State"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(y,{htmlFor:"zipCode",children:"ZIP Code"}),s.jsx(p,{id:"zipCode",value:T.zipCode,onChange:e=>D(s=>({...s,zipCode:e.target.value})),placeholder:"ZIP"})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(u,{type:"submit",disabled:L,children:L?"Updating...":"Update Profile"}),s.jsx(u,{type:"button",onClick:async function(){U(!0);try{if(!(await fetch("/api/user/settings",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(T)})).ok)throw new Error("Failed to update settings");A({title:"Success",description:"Settings updated successfully!"}),I.invalidateQueries({queryKey:["/api/user"]})}catch(e){A({title:"Error",description:"Failed to update settings",variant:"destructive"})}finally{U(!1)}},disabled:L,variant:"outline",children:L?"Saving...":"Save Changes"})]})]})})]})}),s.jsx(w,{value:"notifications",className:"space-y-6",children:s.jsxs(c,{children:[s.jsxs(l,{children:[s.jsxs(n,{className:"flex items-center gap-2",children:[s.jsx(C,{className:"w-5 h-5"}),"Notification Preferences"]}),s.jsx(o,{children:"Choose how you want to receive notifications"})]}),s.jsxs(d,{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-0.5",children:[s.jsx("div",{className:"text-base font-medium",children:"Email Notifications"}),s.jsx("div",{className:"text-sm text-gray-600",children:"Receive notifications via email"})]}),s.jsx(b,{checked:O.emailNotifications,onCheckedChange:e=>J(s=>({...s,emailNotifications:e}))})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-0.5",children:[s.jsx("div",{className:"text-base font-medium",children:"Push Notifications"}),s.jsx("div",{className:"text-sm text-gray-600",children:"Receive browser push notifications"})]}),s.jsx(b,{checked:O.pushNotifications,onCheckedChange:e=>J(s=>({...s,pushNotifications:e}))})]}),s.jsx(u,{children:"Save Notification Settings"})]})]})}),s.jsx(w,{value:"privacy",className:"space-y-6",children:s.jsxs(c,{children:[s.jsxs(l,{children:[s.jsxs(n,{className:"flex items-center gap-2",children:[s.jsx(S,{className:"w-5 h-5"}),"Privacy Settings"]}),s.jsx(o,{children:"Control who can see your information"})]}),s.jsxs(d,{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-0.5",children:[s.jsx("div",{className:"text-base font-medium",children:"Show Location"}),s.jsx("div",{className:"text-sm text-gray-600",children:"Display your city and state on your profile"})]}),s.jsx(b,{checked:O.showLocation,onCheckedChange:e=>J(s=>({...s,showLocation:e}))})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-0.5",children:[s.jsx("div",{className:"text-base font-medium",children:"Show Interests"}),s.jsx("div",{className:"text-sm text-gray-600",children:"Display your interests and topics on your profile"})]}),s.jsx(b,{checked:O.showInterests,onCheckedChange:e=>J(s=>({...s,showInterests:e}))})]}),s.jsx(u,{children:"Save Privacy Settings"})]})]})}),s.jsxs(w,{value:"security",className:"space-y-6",children:[s.jsxs(c,{children:[s.jsxs(l,{children:[s.jsxs(n,{className:"flex items-center gap-2",children:[s.jsx(F,{className:"w-5 h-5"}),"Change Password"]}),s.jsx(o,{children:"Update your account password"})]}),s.jsx(d,{children:s.jsxs("form",{onSubmit:e=>{e.preventDefault(),q.newPassword===q.confirmPassword?q.newPassword.length<6?A({title:"Error",description:"Password must be at least 6 characters long",variant:"destructive"}):Z.mutate({currentPassword:q.currentPassword,newPassword:q.newPassword}):A({title:"Error",description:"New passwords don't match",variant:"destructive"})},className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(y,{htmlFor:"currentPassword",children:"Current Password"}),s.jsx(p,{id:"currentPassword",type:"password",value:q.currentPassword,onChange:e=>B(s=>({...s,currentPassword:e.target.value})),placeholder:"Enter current password"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(y,{htmlFor:"newPassword",children:"New Password"}),s.jsx(p,{id:"newPassword",type:"password",value:q.newPassword,onChange:e=>B(s=>({...s,newPassword:e.target.value})),placeholder:"Enter new password"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(y,{htmlFor:"confirmPassword",children:"Confirm New Password"}),s.jsx(p,{id:"confirmPassword",type:"password",value:q.confirmPassword,onChange:e=>B(s=>({...s,confirmPassword:e.target.value})),placeholder:"Confirm new password"})]}),s.jsx(u,{type:"submit",disabled:Z.isPending,children:Z.isPending?"Updating...":"Update Password"})]})})]}),s.jsxs(c,{children:[s.jsxs(l,{children:[s.jsx(n,{className:"text-red-600",children:"Danger Zone"}),s.jsx(o,{children:"Irreversible account actions"})]}),s.jsx(d,{children:s.jsx(u,{variant:"destructive",onClick:z,children:"Log Out"})})]})]}),s.jsx(w,{value:"organization",className:"space-y-6",children:s.jsxs(c,{children:[s.jsxs(l,{children:[s.jsxs(n,{className:"flex items-center gap-2",children:[s.jsx(k,{className:"w-5 h-5"}),"Church Account"]}),s.jsx(o,{children:"Manage your church or organization account"})]}),s.jsx(d,{className:"space-y-4",children:s.jsxs("div",{className:"text-center py-8",children:[s.jsx(k,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Church Account"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Create a church account to access advanced features like member management, event planning, and premium tools."}),s.jsx(u,{children:"Create Church Account"})]})})]})})]})]}):s.jsx("div",{className:"container mx-auto py-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Please Log In"}),s.jsx("p",{className:"text-gray-600",children:"You need to be logged in to access settings."})]})})}export{E as default};
